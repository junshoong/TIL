<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>TIL - Docker</title><link href="http://til.junshoong.net/" rel="alternate"></link><link href="http://til.junshoong.net/feeds/docker.atom.xml" rel="self"></link><id>http://til.junshoong.net/</id><updated>2017-04-21T00:00:00+09:00</updated><entry><title>[Docker] Data Volume을 사용해서 데이터 지속하기</title><link href="http://til.junshoong.net/docker/persist-data-with-data-volume" rel="alternate"></link><published>2017-04-21T00:00:00+09:00</published><updated>2017-04-21T00:00:00+09:00</updated><author><name>junshoong</name></author><id>tag:til.junshoong.net,2017-04-21:/docker/persist-data-with-data-volume</id><summary type="html">&lt;p&gt;docker와 git-hook을 사용해서 어느정도 프로세스를 자동화하고 있다.
하지만 docker container를 부수고 다시 build 해서 돌리면 내부 데이터가 날아간다. DB의 경우는 &lt;code&gt;--link&lt;/code&gt; 옵션을 이용해서 유지하지만 실제로 upload한 image와 같은 file들의 경우는 컨테이너와 함께 지워진다.&lt;/p&gt;
&lt;p&gt;Data Volume을 사용해서 해결해보자.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker create -v /srv/media --name data-store ubuntu /bin/true
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;이렇게하면 ubuntu 이미지를 …&lt;/p&gt;</summary><content type="html">&lt;p&gt;docker와 git-hook을 사용해서 어느정도 프로세스를 자동화하고 있다.
하지만 docker container를 부수고 다시 build 해서 돌리면 내부 데이터가 날아간다. DB의 경우는 &lt;code&gt;--link&lt;/code&gt; 옵션을 이용해서 유지하지만 실제로 upload한 image와 같은 file들의 경우는 컨테이너와 함께 지워진다.&lt;/p&gt;
&lt;p&gt;Data Volume을 사용해서 해결해보자.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;docker create -v /srv/media --name data-store ubuntu /bin/true
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;이렇게하면 ubuntu 이미지를 기반으로한 Data Volume이 하나 생긴다.
이때 공유된 디렉터리인 &lt;code&gt;/srv/media&lt;/code&gt; 는 다른 컨테이너에 붙여서 사용할 수 있다.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo docker run --name possster --volumes-from media-store -d project
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;지웠다가 다시 만들어서 run해도 동일한 상태를 확인할 수 있다.
또한 여러 컨테이너들과 같은 Data Volume을 공유할 수도 있다.&lt;/p&gt;
&lt;p&gt;아래에서 좀 더 다양한 정보를 확인할 수 있다.
- &lt;a href="https://docs.docker.com/engine/tutorials/dockervolumes/"&gt;docker 공식문서 - Manage data in containers&lt;/a&gt;
- &lt;a href="http://www.tricksofthetrades.net/2016/03/14/docker-data-volumes/"&gt;Tricks of the Trades - Data volumes and Data Containers&lt;/a&gt;
- &lt;a href="https://www.digitalocean.com/community/tutorials/how-to-work-with-docker-data-volumes-on-ubuntu-14-04"&gt;DigitalOcean - How To Work with Docker Data Volumes on Ubuntu 14.04&lt;/a&gt;&lt;/p&gt;</content><category term="docker"></category><category term="data"></category></entry></feed>